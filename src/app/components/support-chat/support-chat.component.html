<!-- Chat icon button (bottom right, rung khi xuất hiện) -->
<button
  [hidden]="showChat"
  class="fixed bottom-6 right-6 z-50 w-16 h-16 rounded-full bg-white shadow-2xl border border-blue-100 flex items-center justify-center hover:bg-blue-100 transition-all ring-2 ring-blue-100/50 animate-shake"
  (click)="toggleChat()"
  aria-label="Open support chat"
>
  <!-- Headset SVG icon support agent -->
  <svg
    width="38"
    height="38"
    fill="none"
    stroke="#2563eb"
    stroke-width="1.9"
    viewBox="0 0 24 24"
  >
    <circle cx="12" cy="10" r="4" stroke-width="1.7" />
    <path d="M4 15v-1a8 8 0 0116 0v1" stroke-width="1.7" />
    <rect x="2" y="15" width="4" height="6" rx="2" stroke-width="1.7" />
    <rect x="18" y="15" width="4" height="6" rx="2" stroke-width="1.7" />
    <path d="M6 21h2a2 2 0 0 0 2-2v-2" stroke-width="1.7" />
    <path d="M18 21h-2a2 2 0 0 1-2-2v-2" stroke-width="1.7" />
  </svg>
</button>

<!-- Chat box -->
<div
  [hidden]="!showChat"
  class="fixed bottom-6 right-6 z-50 w-[370px] max-w-[94vw] bg-white border border-blue-200 rounded-3xl shadow-2xl flex flex-col text-black ring-2 ring-blue-100/60"
>
  <!-- Header -->
  <div
    class="flex items-center justify-between bg-gradient-to-r from-blue-700 to-blue-500 rounded-t-3xl p-4 shadow"
  >
    <div class="flex items-center gap-3">
      <span
        class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white border border-blue-200 shadow-md"
      >
        <!-- Headset icon lặp lại cho avatar agent -->
        <svg
          width="28"
          height="28"
          fill="none"
          stroke="#2563eb"
          stroke-width="1.7"
          viewBox="0 0 24 24"
        >
          <circle cx="12" cy="10" r="4" />
          <path d="M4 15v-1a8 8 0 0116 0v1" />
          <rect x="2" y="15" width="4" height="6" rx="2" />
          <rect x="18" y="15" width="4" height="6" rx="2" />
          <path d="M6 21h2a2 2 0 0 0 2-2v-2" />
          <path d="M18 21h-2a2 2 0 0 1-2-2v-2" />
        </svg>
      </span>
      <div class="flex flex-col">
        <span class="text-white text-base font-bold tracking-wide"
          >AI Hỗ trợ kỹ thuật</span
        >
        <span class="text-xs text-blue-100 mt-0.5">Trực tuyến 24/7</span>
      </div>
    </div>
    <button
      (click)="toggleChat()"
      class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-blue-600/40 transition"
      aria-label="Đóng chat"
    >
      <svg
        width="22"
        height="22"
        fill="none"
        stroke="#fff"
        stroke-width="2"
        viewBox="0 0 24 24"
      >
        <path d="M6 6l12 12M6 18L18 6" stroke-linecap="round" />
      </svg>
    </button>
  </div>

  <!-- Chat body -->
  <div class="flex-1 px-5 py-4 overflow-y-auto text-[15px] bg-[#f6faff]">
    <div class="mb-5 flex gap-2 items-end">
      <span
        class="w-9 h-9 rounded-full bg-blue-100 flex items-center justify-center border border-blue-200 shadow"
      >
        <svg
          width="20"
          height="20"
          fill="none"
          stroke="#2563eb"
          stroke-width="1.5"
          viewBox="0 0 24 24"
        >
          <circle cx="12" cy="10" r="4" />
          <path d="M4 15v-1a8 8 0 0116 0v1" />
        </svg>
      </span>
      <div
        class="bg-white px-4 py-2.5 rounded-2xl shadow text-gray-800 max-w-[220px]"
      >
        Xin chào! Bạn cần hỗ trợ gì về kỹ thuật?
      </div>
    </div>
    <!-- Tin nhắn user demo -->
    <div class="mb-4 flex gap-2 items-end justify-end">
      <div
        class="bg-blue-600 px-4 py-2.5 rounded-2xl text-white shadow max-w-[220px]"
      >
        Em gặp lỗi khi đăng nhập.
      </div>
    </div>
    <!-- ... Thêm messages nếu muốn demo -->
  </div>

  <!-- Input box -->
  <form class="flex items-center p-4 border-t border-blue-100 bg-white">
    <input
      type="text"
      placeholder="Nhập tin nhắn..."
      class="flex-1 px-3 py-2.5 rounded-2xl border border-blue-200 focus:ring-2 focus:ring-blue-300 outline-none text-[15px] bg-[#fcfdff]"
    />
    <button
      type="submit"
      class="ml-3 px-4 py-2.5 bg-blue-600 rounded-2xl text-white font-semibold hover:bg-blue-700 transition"
      disabled
    >
      Gửi
    </button>
  </form>
</div>
